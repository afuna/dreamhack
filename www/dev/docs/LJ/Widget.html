<html><head><title>LJ::Widget</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw " type="text/css" href="../blkbluw_.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk " type="text/css" href="../whtpurk_.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng " type="text/css" href="../whtgrng_.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw " type="text/css" href="../grygrnw_.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.13,
  using Pod::Simple::PullParser v3.13,
  under Perl v5.010001 at Wed Feb 27 00:00:04 2013 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#CONSTRUCTOR'>CONSTRUCTOR</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#AJAX-Related_Methods'>AJAX-Related Methods</a>
    <li class='indexItem indexItem2'><a href='#Flags_for_Widgets'>Flags for Widgets</a>
    <li class='indexItem indexItem2'><a href='#Form_Utility_Methods'>Form Utility Methods</a>
    <li class='indexItem indexItem2'><a href='#Translation_String_Methods'>Translation String Methods</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#EXAMPLES'>EXAMPLES</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>LJ::Widget - parent class for areas of contained information and code (widgets) to be used on one or more BML pages</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    LJ::Widget::WidgetName-&#62;render;
    LJ::Widget::AnotherWidget-&#62;render( options );

    LJ::Widget-&#62;handle_post(\%POST, qw( WidgetName AnotherWidget ));

    my $widget = LJ::Widget::AjaxWidget-&#62;new;
    $headextra .= $widget-&#62;wrapped_js( options );
    $widget-&#62;render;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This is the parent class for widgets. A widget is a part of a BML page that can be relatively self-contained and is sometimes used on multiple pages. Using a widget instead of putting the code directly in a BML page allows more flexibility in terms of re-using code and readability. It is much easier to read and understand a BML page with calls to a couple of widgets than a BML page with large blocks of unrelated code.</p>

<p>Widgets can do POST actions to themselves or to other widgets, but the goal is to keep the function of each widget relatively simple.</p>

<p>POST form elements in a widget are given widget-specific prefixes in their names. These are then removed when the different POST values are being checked in <code>handle_post</code>.</p>

<p>AJAX POSTs go to the endpoint &#34;widget.bml&#34;, and they perform form auths differently than non-AJAX POSTs do.</p>

<p>Strings within widgets can and should be English-stripped. Usually, these strings are defined within en.dat or en_LJ.dat with the string name of &#34;widget.$widgetname.$stringname&#34;. However, these strings can also be defined in BML pages, which will override what&#39;s defined in en(_LJ).dat.</p>

<p>Strings in the &#34;widget&#34; ML domain get there when a user inputs text that should be translatable in a widget web form on the site.</p>

<p>In almost all cases, methods are called on subclasses of this parent class, and not on the parent class itself. It is explicitly noted when a method should be called on the parent class instead of on a subclass.</p>

<p>Also, methods that can be and are often subclassed are noted as such. Most other methods can be subclassed, but it&#39;s probably not particularly useful to do so.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONSTRUCTOR"
>CONSTRUCTOR</a></h1>

<dl>
<dt><a name="new"
><code>new</code></a></dt>

<dd>
<p>This is only needed when you want to create a widget without actually rendering it yet. It is usually called with no options, but you can pass an <code>id</code> to give the widget a defined ID (number) instead of an auto-generated one (useful if you&#39;re using AJAX and widgets get re-rendered and you don&#39;t want IDs to change).</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<dl>
<dt><a name="render"
><code>render</code></a></dt>

<dd>
<p>Renders a widget&#39;s display. It wraps the output of <code>render_body</code> with a div and includes the files defined in <code>need_res</code>. It will return an empty string if <code>should_render</code> returns false. Options passed to it will be passed on to <code>render_body</code>.</p>

<dt><a name="render_body"
><code>render_body</code></a></dt>

<dd>
<p>This is called when <code>render</code> is called. It returns the HTML/BML that should be printed when a widget is rendered. Can be subclassed.</p>

<dt><a name="should_render"
><code>should_render</code></a></dt>

<dd>
<p>Returns if this widget should render or not. It cannot be passed any parameters. It is called automatically when <code>render</code> is called, and by default it will return false if the widget is disabled via <code>is_disabled</code>. Can be subclassed.</p>

<dt><a name="handle_post"
><code>handle_post</code></a></dt>

<dd>
<p>Code that&#39;s run when a widget that POSTs is submitted. This should be called on the parent class instead of on the specific widget, and the widget(s) you want to be handled should be passed as parameters. The parent class method calls the subclass methods appropriately. Returns the hash returned from the last processed widget. Can be subclassed.</p>

<dt><a name="handle_post_and_render"
><code>handle_post_and_render</code></a></dt>

<dd>
<p>This is called on the parent class, and it handles the POST for a single given widget and returns the results of that POST to <code>render</code>.</p>

<dt><a name="need_res"
><code>need_res</code></a></dt>

<dd>
<p>Returns a list of paths to static files that should be included on the page that the widget is called on (i.e. CSS and JS). Can be subclassed.</p>

<dt><a name="need_res_opts"
><code>need_res_opts</code></a></dt>

<dd>
<p>Returns a hash of opts that can be passed to need_res -- for example, ( group =&#62; &#39;jquery&#39; ). Can be subclassed.</p>

<dt><a name="post_fields_by_widget"
><code>post_fields_by_widget</code></a></dt>

<dd>
<p>Returns a hashref of the POST fields for each widget that was handled via <code>handle_post</code> when a POST action occurs. Generally only used as a helper method. Should be called on the parent class.</p>

<dt><a name="post_fields_of_widget"
><code>post_fields_of_widget</code></a></dt>

<dd>
<p>Returns the POST fields for a specific given widget handled via <code>handle_post</code>. Should be called on the parent class.</p>

<dt><a name="post_fields"
><code>post_fields</code></a></dt>

<dd>
<p>Same as <code>post_fields_of_widget</code>, but returns the POST fields for the widget it&#39;s called on.</p>

<dt><a name="use_specific_form_fields"
><code>use_specific_form_fields</code></a></dt>

<dd>
<p>Given the POST values and a list of specific fields, this will allow those fields to be passed into the widget&#39;s <code>handle_post</code> even if they don&#39;t have the necessary widget prefix on them. This is currently used for widgets that have a reCAPTCHA module, since you can&#39;t modify the name of the fields for it.</p>

<dt><a name="get_args"
><code>get_args</code></a></dt>

<dd>
<p>Returns the GET args of the page the widget is on.</p>

<dt><a name="get_effective_remote"
><code>get_effective_remote</code></a></dt>

<dd>
<p>If the widget is an <code>authas</code> widget, it returns the currently authenticated user (remote or a journal remote manages). Otherwise, it returns remote.</p>

<dt><a name="handle_error"
><code>handle_error</code></a></dt>

<dd>
<p>Pushes an error onto a given arrayref of errors (or @BMLCodeBlock::errors) for display.</p>

<dt><a name="error_list"
><code>error_list</code></a></dt>

<dd>
<p>Returns a list of errors for a widget, using <code>handle_error</code> to build up the list in @BMLCodeBlock::errors.</p>

<dt><a name="is_disabled"
><code>is_disabled</code></a></dt>

<dd>
<p>Returns if a widget is disabled or not based on a config hash value.</p>

<dt><a name="subclass"
><code>subclass</code></a></dt>

<dd>
<p>Given a widget package name, returns the name of the widget subclass. Example: giving &#34;LJ::Widget::WidgetName&#34; would return &#34;WidgetName&#34;.</p>

<dt><a name="widget_ele_id"
><code>widget_ele_id</code></a></dt>

<dd>
<p>Returns the HTML id attribute for this widget.</p>

<dt><a name="decl_params"
><code>decl_params</code></a></dt>

<dd>
<p>Wrapper around BML::decl_params().</p>

<dt><a name="form_auth"
><code>form_auth</code></a></dt>

<dd>
<p>Wrapper around LJ::form_auth().</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="AJAX-Related_Methods"
>AJAX-Related Methods</a></h2>

<dl>
<dt><a name="js"
><code>js</code></a></dt>

<dd>
<p>Returns a string of JavaScript for a widget so it does not have to be included as a separate file. Can be subclassed.</p>

<dt><a name="wrapped_js"
><code>wrapped_js</code></a></dt>

<dd>
<p>Returns the JavaScript that&#39;s in <code>js</code>. Also sets up JavaScript so that AJAX widgets can be used. If a <code>page_js_obj</code> parameter is passed in, its value is used to create a JavaScript variable that holds the widget JavaScript object in it.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Flags_for_Widgets"
>Flags for Widgets</a></h2>

<dl>
<dt><a name="ajax"
><code>ajax</code></a></dt>

<dd>
<p>Returns if the widget can accept AJAX POSTs or not. Can be subclassed.</p>

<dt><a name="can_fake_ajax_post"
><code>can_fake_ajax_post</code></a></dt>

<dd>
<p>Returns if a widget can perform AJAX requests via GET instead of POST or not. Can be subclassed.</p>

<dt><a name="authas"
><code>authas</code></a></dt>

<dd>
<p>Returns if a widget supports authas authentication or not (in GET or POST). Can be subclassed.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Form_Utility_Methods"
>Form Utility Methods</a></h2>

<dl>
<dt><a name="start_form"
><code>start_form</code></a></dt>

<dd>
<p>Returns HTML for the start of a form (including form auth) that POSTs to a widget. Can be passed options similar to that of htmlcontrols methods.</p>

<dt><a name="end_form"
><code>end_form</code></a></dt>

<dd>
<p>Returns HTML for the end of a form that POSTs to a widget.</p>

<dt><a name="html_text"
><code>html_text</code></a></dt>

<dd>
<p>Widget-specific HTML text field. Must be used in place of LJ::html_text() if <code>handle_post</code> is being used.</p>

<dt><a name="html_check"
><code>html_check</code></a></dt>

<dd>
<p>Widget-specific HTML text checkbox/radio button. Must be used in place of LJ::html_check() if <code>handle_post</code> is being used.</p>

<dt><a name="html_textarea"
><code>html_textarea</code></a></dt>

<dd>
<p>Widget-specific HTML text area. Must be used in place of LJ::html_textarea() if <code>handle_post</code> is being used.</p>

<dt><a name="html_color"
><code>html_color</code></a></dt>

<dd>
<p>Widget-specific HTML color field. Must be used in place of LJ::html_color() if <code>handle_post</code> is being used.</p>

<dt><a name="html_select"
><code>html_select</code></a></dt>

<dd>
<p>Widget-specific HTML selection box. Must be used in place of LJ::html_select() if <code>handle_post</code> is being used.</p>

<dt><a name="html_datetime"
><code>html_datetime</code></a></dt>

<dd>
<p>Widget-specific HTML datetime field. Must be used in place of LJ::html_datetime() if <code>handle_post</code> is being used.</p>

<dt><a name="html_hidden"
><code>html_hidden</code></a></dt>

<dd>
<p>Widget-specific HTML hidden field. Must be used in place of LJ::html_hidden() if <code>handle_post</code> is being used.</p>

<dt><a name="html_submit"
><code>html_submit</code></a></dt>

<dd>
<p>Widget-specific HTML submit button. Must be used in place of LJ::html_submit() if <code>handle_post</code> is being used.</p>

<dt><a name="input_prefix"
><code>input_prefix</code></a></dt>

<dd>
<p>The prefix that&#39;s added on to form element names to make them widget-specific.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Translation_String_Methods"
>Translation String Methods</a></h2>

<dl>
<dt><a name="ml_key"
><code>ml_key</code></a></dt>

<dd>
<p>The full ML key for a widget string, given the part of the key that&#39;s specific to the string.</p>

<dt><a name="ml_remove_text"
><code>ml_remove_text</code></a></dt>

<dd>
<p>Removes a translation string from the widget ML domain.</p>

<dt><a name="ml_set_text"
><code>ml_set_text</code></a></dt>

<dd>
<p>Adds a translation string to the widget ML domain.</p>

<dt><a name="ml_dmid"
><code>ml_dmid</code></a></dt>

<dd>
<p>Domain ID for the widget ML domain.</p>

<dt><a name="ml_root_lncode"
><code>ml_root_lncode</code></a></dt>

<dd>
<p>Root language for the widget ML domain.</p>

<dt><a name="ml_is_missing_string"
><code>ml_is_missing_string</code></a></dt>

<dd>
<p>Returns if a widget string is missing or not.</p>

<dt><a name="ml"
><code>ml</code></a></dt>

<dd>
<p>Returns the translation string for a given ML key. Can be a general string defined by the page or in en(_LJ).dat, or a string in the widget domain that was defined by a user via a tool.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>See these widgets for some basic examples of different types of widgets:</p>

<pre>    cgi-bin/LJ/Widget/ExampleRenderWidget.pm
    cgi-bin/LJ/Widget/ExamplePostWidget.pm
    cgi-bin/LJ/Widget/ExampleAjaxWidget.pm</pre>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
