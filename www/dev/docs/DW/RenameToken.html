<html><head><title>DW::RenameToken</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw " type="text/css" href="../blkbluw_.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk " type="text/css" href="../whtpurk_.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng " type="text/css" href="../whtgrng_.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw " type="text/css" href="../grygrnw_.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.13,
  using Pod::Simple::PullParser v3.13,
  under Perl v5.010001 at Wed Feb 27 00:00:03 2013 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#API'>API</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24class-%3Ecreate_token'>$class-&#62;create_token</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3Ecreate'>$class-&#62;create</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3Evalid_format(_string_%3D%3E_tokentovalidate_)'>$class-&#62;valid_format( string =&#62; tokentovalidate )</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3Enew'>$class-&#62;new</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3Eby_owner_unused(_userid_%3D%3E_ownerid_)'>$class-&#62;by_owner_unused( userid =&#62; ownerid )</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3Eby_username(_user_%3D%3E_username_)'>$class-&#62;by_username( user =&#62; username )</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3E_encode(_%24id%2C_%24auth_)'>$class-&#62;_encode( $id, $auth )</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3Edecode(_%24invite_)'>$class-&#62;decode( $invite )</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3E_id_encode(_%24num_)'>$class-&#62;_id_encode( $num )</a>
    <li class='indexItem indexItem2'><a href='#%24class-%3E_id_decode(_%24id_)'>$class-&#62;_id_decode( $id )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eapply(_%25opts_)'>$self-&#62;apply( %opts )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Edetails'>$self-&#62;details</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Etoken'>$self-&#62;token</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eapplied'>$self-&#62;applied</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eauth'>$self-&#62;auth</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eid'>$self-&#62;id</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecartid(_%5B_%24cartid_%5D_)'>$self-&#62;cartid( [ $cartid ] )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eownerid'>$self-&#62;ownerid</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Erenuserid'>$self-&#62;renuserid</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Efromuser'>$self-&#62;fromuser</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Etouser'>$self-&#62;touser</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Erendate'>$self-&#62;rendate</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#BUGS'>BUGS</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
  <li class='indexItem indexItem1'><a href='#POD_ERRORS'>POD ERRORS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DW::RenameToken - Token which can be applied to a journal to change the username.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use DW::Rename;

  # create:
  # return a DW::RenameToken object
  my $new_token_obj = DW::RenameToken-&#62;create_token( ownerid =&#62; $u-&#62;id, cartid =&#62; $cart-&#62;id );

  # convenience method which returns the string representation of the token. Same as $token_obj-&#62;token
  my $new_token_string = DW::RenameToken-&#62;create( ownerid =&#62; $u-&#62;id, cartid =&#62; $cart-&#62;id );

  # special token for internal use
  my $internal_token = DW::RenameToken-&#62;create_token( systemtoken =&#62; 1 );


  # try to use...
  my $token_obj = DW::RenameToken-&#62;new( token =&#62; $POST{token} );
  if ( $token_obj-&#62;applied ) { print &#34;Already used&#34; }
  else { $token_obj-&#62;apply( userid =&#62; $id_of_the_journal_being_renamed, from =&#62; $oldname, to =&#62; $newname ) }</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="API"
>API</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;create_token"
><code>$class-&#62;create_token</code></a></h2>

<p>Create a new rename token and return the DW::RenameToken object.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;create"
><code>$class-&#62;create</code></a></h2>

<p>Create a new rename token and return the string token representation of the rename token</p>

<p>Args =item ownerid =&#62; id of the user who gets to use the rename token =item cartid =&#62; id of the cart where this rename token was bought =item systemtoken =&#62; whether this token is owned by the system instead of a user. Used for automatically generated tokens -- manual renames, moving aside a user to ex_* etc. When this is on, the ownerid is ignored.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;valid_format(_string_=&#62;_tokentovalidate_)"
><code>$class-&#62;valid_format( string =&#62; tokentovalidate )</code></a></h2>

<p>Verifies if this could be a valid format for the rename token. Checks length and characters.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;new"
><code>$class-&#62;new</code></a></h2>

<p>Returns object for rename token, given the token string, or undef if none exists.</p>

<dl>
<dt><a name="userid_=&#62;_userid_of_the_journal_being_renamed_=item_from_=&#62;_old_username_=item_to_=&#62;_new_username"
>userid =&#62; userid of the journal being renamed =item from =&#62; old username =item to =&#62; new username</a></dt>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;by_owner_unused(_userid_=&#62;_ownerid_)"
><code>$class-&#62;by_owner_unused( userid =&#62; ownerid )</code></a></h2>

<p>Return a list of unused tokens for this user.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;by_username(_user_=&#62;_username_)"
><code>$class-&#62;by_username( user =&#62; username )</code></a></h2>

<p>Return a list of renames involving this username (either to this username, or from this username)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;_encode(_$id,_$auth_)"
><code>$class-&#62;_encode( $id, $auth )</code></a></h2>

<p>Internal. Given a rename token id and a 13-digit auth code, returns a 20-digit all-uppercase rename token.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;decode(_$invite_)"
><code>$class-&#62;decode( $invite )</code></a></h2>

<p>Internal. Given a rename token, break it down into its component parts: a rename token id and a 13-character auth code.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;_id_encode(_$num_)"
><code>$class-&#62;_id_encode( $num )</code></a></h2>

<p>Internal. Converts a 32-bit unsigned integer into a fixed-width string representation in base DIGITS_LEN, based on an alphabet of letters and numbers that are not easily mistaken for each other.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;_id_decode(_$id_)"
><code>$class-&#62;_id_decode( $id )</code></a></h2>

<p>Internal. Given an id encoding from <code>DW::RenameToken::_id_encode</code>, returns the original decimal number.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;apply(_%opts_)"
><code>$self-&#62;apply( %opts )</code></a></h2>

<p>Record information about how this rename token was applied.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;details"
><code>$self-&#62;details</code></a></h2>

<p>Get the details from the log for admin use. Not cached and pretty inefficient. Also, does not check for privs (leave that to the caller)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;token"
><code>$self-&#62;token</code></a></h2>

<p>The string representation of the token (formed by a combination of the auth code and the id)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;applied"
><code>$self-&#62;applied</code></a></h2>

<p>Whether this token has been used.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;auth"
><code>$self-&#62;auth</code></a></h2>

<p>The auth code, randomly generated characters. Not necesarily unique.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;id"
><code>$self-&#62;id</code></a></h2>

<p>Unique id for the rename token.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;cartid(_[_$cartid_]_)"
><code>$self-&#62;cartid( [ $cartid ] )</code></a></h2>

<p>Gets / sets cart where we can look up payment information. May be 0, if the rename token did not pass through the payment system.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;ownerid"
><code>$self-&#62;ownerid</code></a></h2>

<p>Owner of the rename token; the one who actually did the applying. May be different from the user who owns/bought the rename token in case of gifts, or of renaming of communities, or a system admin doing the rename</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;renuserid"
><code>$self-&#62;renuserid</code></a></h2>

<p>User id that the rename token was applied to.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;fromuser"
><code>$self-&#62;fromuser</code></a></h2>

<p>Original username.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;touser"
><code>$self-&#62;touser</code></a></h2>

<p>New username.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;rendate"
><code>$self-&#62;rendate</code></a></h2>

<p>UNIX timestamp the token was used.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BUGS"
>BUGS</a></h1>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<p>Afuna &#60;coder.dw@afunamatata.com&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE</a></h1>

<p>Copyright (c) 2010 by Dreamwidth Studios, LLC.</p>

<p>This program is free software; you may redistribute it and/or modify it under the same terms as Perl itself. For a copy of the license, please reference &#39;perldoc perlartistic&#39; or &#39;perldoc perlgpl&#39;.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="POD_ERRORS"
>POD ERRORS</a></h1>

<p>Hey! <b>The above document had some coding errors, which are explained below:</b></p>

<dl>
<dt><a name="Around_line_126:"
>Around line 126:</a></dt>

<dd>
<p>&#39;=item&#39; outside of any &#39;=over&#39;</p>

<dt><a name="Around_line_153:"
>Around line 153:</a></dt>

<dd>
<p>You forgot a &#39;=back&#39; before &#39;=head2&#39;</p>
</dd>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
