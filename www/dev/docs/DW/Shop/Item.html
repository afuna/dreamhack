<html><head><title>DW::Shop::Item</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw " type="text/css" href="../../blkbluw_.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk " type="text/css" href="../../whtpurk_.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng " type="text/css" href="../../whtgrng_.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw " type="text/css" href="../../grygrnw_.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.13,
  using Pod::Simple::PullParser v3.13,
  under Perl v5.010001 at Wed Feb 27 00:00:03 2013 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#API'>API</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24class-%3Enew(_%5B_%24opts_%5D_)'>$class-&#62;new( [ $opts ] )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eapply_automatically'>$self-&#62;apply_automatically</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eapply'>$self-&#62;apply</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3E_apply'>$self-&#62;_apply</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eunapply'>$self-&#62;unapply</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecart_state_changed(_%24cart%2C_%24newstate_)'>$self-&#62;cart_state_changed( $cart, $newstate )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecan_be_added(_%5B_%25opts_%5D_)'>$self-&#62;can_be_added( [ %opts ] )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecan_have_reason(_%5B_%25opts_%5D_)'>$self-&#62;can_have_reason( [ %opts ] )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Econflicts(_%24item_)'>$self-&#62;conflicts( $item )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Et_html(_%5B_%25opts_%5D_)'>$self-&#62;t_html( [ %opts ] )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ename_text'>$self-&#62;name_text</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ename_html'>$self-&#62;name_html</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Enote'>$self-&#62;note</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eshort_desc'>$self-&#62;short_desc</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eid(_%24id_)'>$self-&#62;id( $id )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecartid(_%24cartid_)'>$self-&#62;cartid( $cartid )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Et_userid(_%24target_userid_)'>$self-&#62;t_userid( $target_userid )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Efrom_html'>$self-&#62;from_html</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Epaid_cash'>$self-&#62;paid_cash</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Epaid_points'>$self-&#62;paid_points</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Edisplay_paid'>$self-&#62;display_paid</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Edisplay_paid_cash'>$self-&#62;display_paid_cash</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Edisplay_paid_points'>$self-&#62;display_paid_points</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eapplied'>$self-&#62;applied</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecost_cash'>$self-&#62;cost_cash</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecost_points'>$self-&#62;cost_points</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Et_email'>$self-&#62;t_email</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Efrom_userid'>$self-&#62;from_userid</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Edeliverydate'>$self-&#62;deliverydate</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eanonymous'>$self-&#62;anonymous</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Enoremove'>$self-&#62;noremove</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Efrom_name'>$self-&#62;from_name</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ereason'>$self-&#62;reason</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Ecannot_conflict'>$self-&#62;cannot_conflict</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DW::Shop::Item - base class containing basic behavior for items to be sold in the shop</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="API"
>API</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$class-&#62;new(_[_$opts_]_)"
><code>$class-&#62;new( [ $opts ] )</code></a></h2>

<p>Instantiates an item to be purchased in the shop.
The item must be defined in the %LJ::SHOP hash in your config file.</p>

<p>Arguments: =item type =&#62; item type,
passed in by a subclass.
Must be configured in %LJ::SHOP =item target_userid =&#62; userid,
=item target_email =&#62; email,
=item from_userid =&#62; userid,
=item deliverydate =&#62; &#34;yyyy-mm-dd&#34;,
=item anonymous =&#62; 1,
=item anonymous_target =&#62; 1,
=item cannot_conflict =&#62; 1,
=item noremove =&#62; 1,
=item from_name =&#62; sender name,
=item reason =&#62; personal note from sender to target</p>

<p>The type is required.
Also,
one target_* argument is required; it may be either a target_userid or a target_email.
All other arguments are optional.</p>

<p>Subclasses must override this function to set the type.
Subclasses may also do any other modifications necessary when instantiating itself.
See DW::Shop::Item::Account for an example.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;apply_automatically"
><code>$self-&#62;apply_automatically</code></a></h2>

<p>True if you want the item to be applied via the paidstatus worker,
and false if you wish to apply the item yourself (usually triggered by a user action).</p>

<p>Subclasses may override.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;apply"
><code>$self-&#62;apply</code></a></h2>

<p>Called when we are told we need to apply this item,
i.e.,
turn it on.
Note that we update ourselves,
but it&#39;s up to the cart to make sure that it saves.</p>

<p>Subclasses may override this method,
but a better approach would be to override the internal $self-&#62;_apply method.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;_apply"
><code>$self-&#62;_apply</code></a></h2>

<p>Internal application sub.</p>

<p>Subclasses must override this for item-specific behavior.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;unapply"
><code>$self-&#62;unapply</code></a></h2>

<p>Called when we need to turn this item off.</p>

<p>Subclasses may override this to add additional behavior or warnings.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;cart_state_changed(_$cart,_$newstate_)"
><code>$self-&#62;cart_state_changed( $cart,
$newstate )</code></a></h2>

<p>Hook in the cart for custom behavior once the cart has been changed.</p>

<p>Subclasses may override this for custom behavior: for example,
creating a token or certificate once the cart has been paid for.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;can_be_added(_[_%opts_]_)"
><code>$self-&#62;can_be_added( [ %opts ] )</code></a></h2>

<p>Returns 1 if this item is allowed to be added to the shopping cart.</p>

<p>Subclasses must override this.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;can_have_reason(_[_%opts_]_)"
><code>$self-&#62;can_have_reason( [ %opts ] )</code></a></h2>

<p>Returns 1 if this item is allowed to have a personal note from the sender explaining the reason for the gift.</p>

<p>Subclasses must override this in order to disallow.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;conflicts(_$item_)"
><code>$self-&#62;conflicts( $item )</code></a></h2>

<p>Given another item,
see if that item conflicts with this item (i.e.,
if you can&#39;t have both in your shopping cart at the same time).</p>

<p>Returns undef on &#34;no conflict&#34; else an error message.</p>

<p>Subclasses may override.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;t_html(_[_%opts_]_)"
><code>$self-&#62;t_html( [ %opts ] )</code></a></h2>

<p>Render our target as a string.</p>

<p>Subclasses may override.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;name_text"
><code>$self-&#62;name_text</code></a></h2>

<p>Render the item name as a string,
for display,
to be used in contexts which don&#39;t allow HTML.</p>

<p>Subclasses must override to provide a more specific and user-friendly display name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;name_html"
><code>$self-&#62;name_html</code></a></h2>

<p>Render the item name as a string for display,
to be used in contexts which accept HTML.</p>

<p>Subclasses may override to provide a version of the name containing HTML.
Uses $self-&#62;name_text by default.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;note"
><code>$self-&#62;note</code></a></h2>

<p>Render a note to the user about this item.</p>

<p>Subclasses may override to provide a brief note about this item.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;short_desc"
><code>$self-&#62;short_desc</code></a></h2>

<p>Returns a short string talking about what this is.</p>

<p>Subclasses may override to provide further description.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;id(_$id_)"
><code>$self-&#62;id( $id )</code></a></h2>

<p>This is a getter/setter so it is pulled out.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;cartid(_$cartid_)"
><code>$self-&#62;cartid( $cartid )</code></a></h2>

<p>Gets/sets.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;t_userid(_$target_userid_)"
><code>$self-&#62;t_userid( $target_userid )</code></a></h2>

<p>Gets/sets.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;from_html"
><code>$self-&#62;from_html</code></a></h2>

<p>Display who this is from.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;paid_cash"
><code>$self-&#62;paid_cash</code></a></h2>

<p>Returns the amount paid for this item in USD.
This varies from cart to cart and item to item and is a reflection of the actual amount of cash paid for this item.
paid_points may also be non-zero.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;paid_points"
><code>$self-&#62;paid_points</code></a></h2>

<p>Returns the amount paid in points for this item.
This varies just like the paid_cash item,
which may also be non-zero for items that a user paid both cash and points for.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;display_paid"
><code>$self-&#62;display_paid</code></a></h2>

<p>Displays how much cash and/or points this item costs right now.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;display_paid_cash"
><code>$self-&#62;display_paid_cash</code></a></h2>

<p>Display how much cash this item costs right now.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;display_paid_points"
><code>$self-&#62;display_paid_points</code></a></h2>

<p>Display how many points this item costs right now.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;applied"
><code>$self-&#62;applied</code></a></h2>

<p>Returns whether the item which was bought has been already applied</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;cost_cash"
><code>$self-&#62;cost_cash</code></a></h2>

<p>Returns the cost in USD of the item,
as configured for this site.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;cost_points"
><code>$self-&#62;cost_points</code></a></h2>

<p>Returns the cost in points of the item,
as configured for this site.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;t_email"
><code>$self-&#62;t_email</code></a></h2>

<p>Returns the target email this item was sent to.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;from_userid"
><code>$self-&#62;from_userid</code></a></h2>

<p>Returns the userid of the person who bought this item.
May be 0.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;deliverydate"
><code>$self-&#62;deliverydate</code></a></h2>

<p>Returns the date this item should be delivered,
in &#34;yyyy-mm-dd&#34; format</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;anonymous"
><code>$self-&#62;anonymous</code></a></h2>

<p>Returns whether this item should be gifted anonymously,
or credited to the sender</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;noremove"
><code>$self-&#62;noremove</code></a></h2>

<p>Returns whether this item may or may not be removed from the cart.
May be used by promotions which automatically add a promo item to a user&#39;s cart,
to prevent the promo item from being removed</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;from_name"
><code>$self-&#62;from_name</code></a></h2>

<p>Name of the sender in special cases.
For example,
can be the site name for promotions.
Not exposed/settable via the shop.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;reason"
><code>$self-&#62;reason</code></a></h2>

<p>Optional note from the sender explaining the reason for the gift.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;cannot_conflict"
><code>$self-&#62;cannot_conflict</code></a></h2>

<p>Returns whether this item may never conflict with any other item.
If true,
skip checks for conflict.</p>

<p>Subclasses may override.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
