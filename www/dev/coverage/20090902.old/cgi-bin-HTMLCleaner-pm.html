<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 0.61
Devel::Cover is copyright 2001-2006, Paul Johnson (pjcj@cpan.org)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: cgi-bin/HTMLCleaner.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">cgi-bin/HTMLCleaner.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">67.2%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#!/usr/bin/perl</td></tr>
<tr><td class="h">2</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">3</td><td colspan="7"></td></tr><tr><td class="h">4</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">package HTMLCleaner;</td></tr>
<tr><td class="h">5</td><td colspan="7"></td></tr><tr><td class="h">6</td><td><div class="c3">7</div><div class="c3">7</div><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L6">7</a></div></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">7</td><td><div class="c3">7</div><div class="c3">7</div><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L7">7</a></div></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">use base &#39;HTML::Parser&#39;;</td></tr>
<tr><td class="h">8</td><td><div class="c3">7</div><div class="c3">7</div><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L8">7</a></div></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">use CSS::Cleaner;</td></tr>
<tr><td class="h">9</td><td colspan="7"></td></tr><tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">11</td><td><div class="c3">50</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L11">50</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($class, %opts) = @_;</td></tr>
<tr><td class="h">12</td><td colspan="7"></td></tr><tr><td class="h">13</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $p = new HTML::Parser(&#39;api_version&#39; =&gt; 3);</td></tr>
<tr><td class="h">14</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>4000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;handler(&#39;start&#39; =&gt;  \&amp;start, &#39;self, tagname, attr, attrseq, text&#39; );</td></tr>
<tr><td class="h">15</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;handler(&#39;end&#39; =&gt;  \&amp;end, &#39;self, tagname&#39; );</td></tr>
<tr><td class="h">16</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;handler(&#39;text&#39; =&gt;  \&amp;text, &#39;self, text&#39; );</td></tr>
<tr><td class="h">17</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>4001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;handler(&#39;declaration&#39; =&gt;  \&amp;decl, &#39;self, tokens&#39; );</td></tr>
<tr><td class="h">18</td><td colspan="7"></td></tr><tr><td class="h">19</td><td><div class="c3">50</div><div class="c0">0</div></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--condition.html#L19">100</a></div></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L19">0</a></div></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;{&#39;output&#39;}  = $opts{&#39;output&#39;} || sub {};</td></tr>
<tr><td class="h">20</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>4000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;{&#39;cleaner&#39;} = CSS::Cleaner-&gt;new;</td></tr>
<tr><td class="h">21</td><td><div class="c3">50</div><div class="c0">0</div></td><td></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--condition.html#L21">50</a></div></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L21">0</a></div></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;{&#39;valid_stylesheet&#39;} = $opts{&#39;valid_stylesheet&#39;} || sub { 1 };</td></tr>
<tr><td class="h">22</td><td><div class="c3">50</div></td><td></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--condition.html#L22">50</a></div></td><td></td><td></td><td><div>8000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$p-&gt;{&#39;allow_password_input&#39;} = $opts{&#39;allow_password_input&#39;} || 0;</td></tr>
<tr><td class="h">23</td><td colspan="7"></td></tr><tr><td class="h">24</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;bless $p, $class;</td></tr>
<tr><td class="h">25</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">26</td><td colspan="7"></td></tr><tr><td class="h">27</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %bad_attr = (map { $_ =&gt; 1 }</td></tr>
<tr><td class="h">28</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qw(datasrc datafld));</td></tr>
<tr><td class="h">29</td><td colspan="7"></td></tr><tr><td class="h">30</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %eat_tag = (map { $_ =&gt; 1 }</td></tr>
<tr><td class="h">31</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qw(script iframe object applet embed param));</td></tr>
<tr><td class="h">32</td><td colspan="7"></td></tr><tr><td class="h">33</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @eating;  # push tagname whenever we start eating a tag</td></tr>
<tr><td class="h">34</td><td colspan="7"></td></tr><tr><td class="h">35</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub start {</td></tr>
<tr><td class="h">36</td><td><div class="c3">9</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L36">9</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($self, $tagname, $attr, $seq, $text) = @_;</td></tr>
<tr><td class="h">37</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$tagname =~ s/&lt;//;</td></tr>
<tr><td class="h">38</td><td colspan="7"></td></tr><tr><td class="h">39</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $slashclose = 0;  # xml-style</td></tr>
<tr><td class="h">40</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L40">50</a></div></td><td></td><td></td><td></td><td><div>4000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($tagname =~ s!/(.*)!!) {</td></tr>
<tr><td class="h">41</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L41">0</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (length($1)) { push @eating, &quot;$tagname/$1&quot;; } # basically halt parsing</td></tr>
<tr><td class="h">42</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else { $slashclose = 1; }</td></tr>
<tr><td class="h">43</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">44</td><td colspan="7"></td></tr><tr><td class="h">45</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @allowed_tags = (&#39;lj-embed&#39;);</td></tr>
<tr><td class="h">46</td><td colspan="7"></td></tr><tr><td class="h">47</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @eating, $tagname if</td></tr>
<tr><td class="h">48</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L48">50</a></div></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--condition.html#L48">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$eat_tag{$tagname} &amp;&amp; ! grep { lc $tagname eq $_ } @allowed_tags;</td></tr>
<tr><td class="h">49</td><td colspan="7"></td></tr><tr><td class="h">50</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L50">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if @eating;</td></tr>
<tr><td class="h">51</td><td colspan="7"></td></tr><tr><td class="h">52</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $clean_res = eval {</td></tr>
<tr><td class="h">53</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cleantag = $tagname;</td></tr>
<tr><td class="h">54</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cleantag =~ s/^.*://s;</td></tr>
<tr><td class="h">55</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cleantag =~ s/[^\w]//g;</td></tr>
<tr><td class="h">56</td><td><div class="c3">7</div><div class="c3">7</div><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L56">7</a></div></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no strict &#39;subs&#39;;</td></tr>
<tr><td class="h">57</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $meth = &quot;CLEAN_$cleantag&quot;;</td></tr>
<tr><td class="h">58</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L58">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $code = $self-&gt;can($meth)</td></tr>
<tr><td class="h">59</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or return 1;  # don&#39;t clean, if no element-specific cleaner method</td></tr>
<tr><td class="h">60</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $code-&gt;($self, $seq, $attr);</td></tr>
<tr><td class="h">61</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">62</td><td><div class="c3">9</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L62">100</a></div></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--condition.html#L62">67</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !$@ &amp;&amp; !$clean_res;</td></tr>
<tr><td class="h">63</td><td colspan="7"></td></tr><tr><td class="h">64</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ret = &quot;&lt;$tagname&quot;;</td></tr>
<tr><td class="h">65</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach (@$seq) {</td></tr>
<tr><td class="h">66</td><td><div class="c3">10</div><div class="c3">1</div><div class="c3">1</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L66">100</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($_ eq &quot;/&quot;) { $slashclose = 1; next; }</td></tr>
<tr><td class="h">67</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L67">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $bad_attr{lc($_)};</td></tr>
<tr><td class="h">68</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L68">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if /^on/i;</td></tr>
<tr><td class="h">69</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L69">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if /(?:^=)|[\x0b\x0d]/;</td></tr>
<tr><td class="h">70</td><td colspan="7"></td></tr><tr><td class="h">71</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L71">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($_ eq &quot;style&quot;) {</td></tr>
<tr><td class="h">72</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$attr-&gt;{$_} = $self-&gt;{cleaner}-&gt;clean_property($attr-&gt;{$_});</td></tr>
<tr><td class="h">73</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">74</td><td colspan="7"></td></tr><tr><td class="h">75</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L75">50</a></div></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--condition.html#L75">20</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($tagname eq &#39;input&#39; &amp;&amp; $_ eq &#39;type&#39;  &amp;&amp; $attr-&gt;{&#39;type&#39;} =~ /^password$/i &amp;&amp; !$self-&gt;{&#39;allow_password_input&#39;}) {</td></tr>
<tr><td class="h">76</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $attr-&gt;{&#39;type&#39;};</td></tr>
<tr><td class="h">77</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">78</td><td colspan="7"></td></tr><tr><td class="h">79</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>4001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nospace = $attr-&gt;{$_};</td></tr>
<tr><td class="h">80</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nospace =~ s/[\s\0]//g;</td></tr>
<tr><td class="h">81</td><td colspan="7"></td></tr><tr><td class="h">82</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# IE is brain-dead and lets javascript:, vbscript:, and about: have spaces mixed in</td></tr>
<tr><td class="h">83</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L83">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nospace =~ /(?:(?:(?:vb|java)script)|about):/i) {</td></tr>
<tr><td class="h">84</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $attr-&gt;{$_};</td></tr>
<tr><td class="h">85</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">86</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret .= &quot; $_=\&quot;&quot; . ehtml($attr-&gt;{$_}) . &quot;\&quot;&quot;;</td></tr>
<tr><td class="h">87</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">88</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L88">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ret .= &quot; /&quot; if $slashclose;</td></tr>
<tr><td class="h">89</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ret .= &quot;&gt;&quot;;</td></tr>
<tr><td class="h">90</td><td colspan="7"></td></tr><tr><td class="h">91</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L91">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($tagname eq &quot;style&quot;) {</td></tr>
<tr><td class="h">92</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;_eating_style&#39;} = 1;</td></tr>
<tr><td class="h">93</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;_style_contents&#39;} = &quot;&quot;;</td></tr>
<tr><td class="h">94</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">95</td><td colspan="7"></td></tr><tr><td class="h">96</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;output&#39;}-&gt;($ret);</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">98</td><td colspan="7"></td></tr><tr><td class="h">99</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub CLEAN_meta {</td></tr>
<tr><td class="h">100</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L100">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($self, $seq, $attr) = @_;</td></tr>
<tr><td class="h">101</td><td colspan="7"></td></tr><tr><td class="h">102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# don&#39;t allow refresh because it can refresh to javascript URLs</td></tr>
<tr><td class="h">103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# don&#39;t allow content-type because they can set charset to utf-7</td></tr>
<tr><td class="h">104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# why do we even allow meta tags?</td></tr>
<tr><td class="h">105</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $equiv = lc $attr-&gt;{&quot;http-equiv&quot;};</td></tr>
<tr><td class="h">106</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L106">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($equiv) {</td></tr>
<tr><td class="h">107</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$equiv =~ s/[\s\x0b]//;</td></tr>
<tr><td class="h">108</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L108">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 if $equiv =~ /refresh|content-type|link|set-cookie/;</td></tr>
<tr><td class="h">109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">110</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">112</td><td colspan="7"></td></tr><tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub CLEAN_link {</td></tr>
<tr><td class="h">114</td><td><div class="c3">9</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L114">9</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($self, $seq, $attr) = @_;</td></tr>
<tr><td class="h">115</td><td colspan="7"></td></tr><tr><td class="h">116</td><td><div class="c3">9</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L116">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($attr-&gt;{rel} =~ /\bstylesheet\b/i) {</td></tr>
<tr><td class="h">117</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $attr-&gt;{href};</td></tr>
<tr><td class="h">118</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L118">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 unless $href =~ m!^https?://([^/]+?)(/.*)$!;</td></tr>
<tr><td class="h">119</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($host, $path) = ($1, $2);</td></tr>
<tr><td class="h">120</td><td colspan="7"></td></tr><tr><td class="h">121</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rv = $self-&gt;{&#39;valid_stylesheet&#39;}-&gt;($href, $host, $path);</td></tr>
<tr><td class="h">122</td><td><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L122">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($rv == 1) {</td></tr>
<tr><td class="h">123</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">125</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L125">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($rv) {</td></tr>
<tr><td class="h">126</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$attr-&gt;{href} = $rv;</td></tr>
<tr><td class="h">127</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">129</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">131</td><td colspan="7"></td></tr><tr><td class="h">132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Allow blank &lt;link&gt; tags through so RSS S2 styles can work again without the &#39;rel=&quot;alternate&quot;&#39; hack</td></tr>
<tr><td class="h">133</td><td><div class="c3">7</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L133">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if (keys( %$attr ) == 0);</td></tr>
<tr><td class="h">134</td><td colspan="7"></td></tr><tr><td class="h">135</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L135">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $attr-&gt;{rel} =~ /^(?:service|openid)\.\w+$/;</td></tr>
<tr><td class="h">136</td><td><div class="c3">6</div><div class="c3">156</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %okay = map { $_ =&gt; 1 } (qw(icon shortcut alternate next prev index made start search top help up author edituri file-list previous home contents bookmark chapter section subsection appendix glossary copyright child));</td></tr>
<tr><td class="h">137</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L137">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $okay{lc($attr-&gt;{rel})};</td></tr>
<tr><td class="h">138</td><td colspan="7"></td></tr><tr><td class="h">139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Allow link tags with only an href tag. This is an implied rel=&quot;alternate&quot;</td></tr>
<tr><td class="h">140</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L140">50</a></div></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--condition.html#L140">67</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if (exists( $attr-&gt;{href} ) and (keys( %$attr ) == 1));</td></tr>
<tr><td class="h">141</td><td colspan="7"></td></tr><tr><td class="h">142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Allow combinations of rel attributes through as long as all of them are valid, most notably &quot;shortcut icon&quot;</td></tr>
<tr><td class="h">143</td><td><div class="c3">4</div><div class="c3">5</div></td><td><div class="c3" title="T/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L143">100</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 unless grep { !$okay{$_} } split( /\s+/, $attr-&gt;{rel} );</td></tr>
<tr><td class="h">144</td><td colspan="7"></td></tr><tr><td class="h">145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# unknown link tag</td></tr>
<tr><td class="h">146</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">148</td><td colspan="7"></td></tr><tr><td class="h">149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub end {</td></tr>
<tr><td class="h">150</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L150">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($self, $tagname) = @_;</td></tr>
<tr><td class="h">151</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L151">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@eating) {</td></tr>
<tr><td class="h">152</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L152">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop @eating if $eating[-1] eq $tagname;</td></tr>
<tr><td class="h">153</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">155</td><td colspan="7"></td></tr><tr><td class="h">156</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L156">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($self-&gt;{&#39;_eating_style&#39;}) {</td></tr>
<tr><td class="h">157</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;_eating_style&#39;} = 0;</td></tr>
<tr><td class="h">158</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;output&#39;}-&gt;($self-&gt;{cleaner}-&gt;clean($self-&gt;{&#39;_style_contents&#39;}));</td></tr>
<tr><td class="h">159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">160</td><td colspan="7"></td></tr><tr><td class="h">161</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;output&#39;}-&gt;(&quot;&lt;/$tagname&gt;&quot;);</td></tr>
<tr><td class="h">162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">163</td><td colspan="7"></td></tr><tr><td class="h">164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub text {</td></tr>
<tr><td class="h">165</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L165">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($self, $text) = @_;</td></tr>
<tr><td class="h">166</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L166">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if @eating;</td></tr>
<tr><td class="h">167</td><td colspan="7"></td></tr><tr><td class="h">168</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L168">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($self-&gt;{&#39;_eating_style&#39;}) {</td></tr>
<tr><td class="h">169</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;_style_contents&#39;} .= $text;</td></tr>
<tr><td class="h">170</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">172</td><td colspan="7"></td></tr><tr><td class="h">173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# this string is magic [hack].  (See $out_straight in</td></tr>
<tr><td class="h">174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# cgi-bin/LJ/S2.pm) callers can print &quot;&lt;!-- --&gt;&quot; to HTML::Parser</td></tr>
<tr><td class="h">175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# just to make it flush, since HTML::Parser has no</td></tr>
<tr><td class="h">176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# -&gt;flush_outstanding text tag.</td></tr>
<tr><td class="h">177</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="cgi-bin-HTMLCleaner-pm--branch.html#L177">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $text eq &quot;&lt;!-- --&gt;&quot;;</td></tr>
<tr><td class="h">178</td><td colspan="7"></td></tr><tr><td class="h">179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# the parser gives us back text whenever it&#39;s confused</td></tr>
<tr><td class="h">180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# on really broken input.  sadly, IE parses really broken</td></tr>
<tr><td class="h">181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# input, so let&#39;s escape anything going out this way.</td></tr>
<tr><td class="h">182</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;output&#39;}-&gt;(eangles($text));</td></tr>
<tr><td class="h">183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">184</td><td colspan="7"></td></tr><tr><td class="h">185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub decl {</td></tr>
<tr><td class="h">186</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L186">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($self, $tokens) = @_;</td></tr>
<tr><td class="h">187</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;output&#39;}-&gt;(&quot;&lt;!&quot; . join(&quot; &quot;, map { eangles($_) } @$tokens) . &quot;&gt;&quot;);</td></tr>
<tr><td class="h">188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">189</td><td colspan="7"></td></tr><tr><td class="h">190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub eangles {</td></tr>
<tr><td class="h">191</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L191">1</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $a = shift;</td></tr>
<tr><td class="h">192</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a =~ s/&lt;/&amp;lt;/g;</td></tr>
<tr><td class="h">193</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a =~ s/&gt;/&amp;gt;/g;</td></tr>
<tr><td class="h">194</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $a;</td></tr>
<tr><td class="h">195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">196</td><td colspan="7"></td></tr><tr><td class="h">197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub ehtml {</td></tr>
<tr><td class="h">198</td><td><div class="c3">9</div></td><td></td><td></td><td><div class="c3"><a href="cgi-bin-HTMLCleaner-pm--subroutine.html#L198">9</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $a = shift;</td></tr>
<tr><td class="h">199</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a =~ s/\&amp;/&amp;amp;/g;</td></tr>
<tr><td class="h">200</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a =~ s/\&quot;/&amp;quot;/g;</td></tr>
<tr><td class="h">201</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a =~ s/\&#39;/&amp;\#39;/g;</td></tr>
<tr><td class="h">202</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a =~ s/&lt;/&amp;lt;/g;</td></tr>
<tr><td class="h">203</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a =~ s/&gt;/&amp;gt;/g;</td></tr>
<tr><td class="h">204</td><td><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $a;</td></tr>
<tr><td class="h">205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">206</td><td colspan="7"></td></tr><tr><td class="h">207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
